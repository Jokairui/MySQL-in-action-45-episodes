### Cue

函数操作会导致索引失效吗

等号左右的函数操作有什么区别

放弃树搜索并不一定表示完全放弃索引，例如count(*)的优化依然会使得MySQL只遍历最小的索引树

### Notes

####函数操作导致的索引失效

1. 对字段进行函数操作，会导致MySQL放弃索引的树搜索功能
2. 优化器的偷懒欣慰，例如where id + 1 = 1000 会放弃索引功能，而where id = 1000 -1 则不会

#### 隐式类型转换

* 对于字符串字段tradeid来说，where tradeid = 123456 相当于 where CAST(tradeid AS signed int ) = 123456
* 主动写成where tradeid = ‘123456’ 就能走索引树搜索
* 如何判断数据库是数字转字符串还是字符串转数字？select “10” > 9 ，如果true，规则是字符串转数字，否则，是数字转字符串

#### 隐式字符编码转换

通常出现在表连接操作的时候出现，本质也是因为字符集转换产生了函数操作

最优解是将两个表的字符集改成一致

次优解可以手动写字符编码的函数操作，将函数操作写在等号的左边

### Summary

等号左边的函数操作会导致MySQL放弃对应字段的索引树搜索，而等号右边的函数操作则不会。

隐式类型转换和隐式字符编码转换导致慢查询的本质原因依然是函数操作导致的，放弃索引树搜索。