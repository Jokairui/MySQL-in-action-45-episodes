## 8 事务到底是隔离的还是不隔离的？

#### 一致性读 

即可重复读隔离级别的概念，一个事务执行期间看到的变更，总是跟它启动前看到的变更保持一致。 更精确的说，是跟它启动并创建一致性视图（Read View）时看到的变更保持一致 

#### 当前读 

首先，当前读会加行锁，所有的update语句都会先执行当前读。所谓当前读，可以理解为与事务隔离无关，只会读取当前这一时刻该行记录已经更新完成的数据，当然，如果更新最新数据的事务还未提交的话，当前读会进入锁等待，直到对应事务完成提交 

#### MVCC

在Repeatable Read隔离级别下，每一个事务开始都会给整个库拍一个“快照”，拍的就是所有当前行的transation_id，记为row trx_id，在查看一行数据的时候，会通过事务可见性来判断是否使用undo log回滚到最近的可见版本 

#### Transaction_id

每一个事务开始时，都会向Innodb 事务系统申请一个事务ID，它是严格递增的可重复读与读提交的区别 

#### Undo log

一行数据的更改会记录到undo log中，以transation_id作为版本标识 

#### Start transcation with consistent snapshot

使用`start/begin transation`并不是一个事务真正的起点，在它之后执行的第一条SQL才是 想要真正立即开始一个事务，可以使用`start transcation with consistent snapshot`这条命令。 

